# Document Generation Schemas

GenerateDocumentRequest:
  type: object
  description: Request to generate a single document
  required:
    - templateId
    - variantId
    - data
  properties:
    templateId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of template to use for generation
      example: invoice
    variantId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of the variant to use
      example: english
    versionId:
      type: [integer, "null"]
      minimum: 1
      maximum: 200
      description: Explicit version ID (version number, 1-200, mutually exclusive with environmentId)
      example: 1
    environmentId:
      type: [string, "null"]
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 30
      description: Slug identifier of environment to determine version from (mutually exclusive with versionId)
      example: null
    data:
      type: object
      description: JSON data to populate the template
      example:
        customerName: "Jane Smith"
        invoiceNumber: "INV-2026-001"
        amount: 1250.00
    filename:
      type: [string, "null"]
      description: Optional filename for the generated document
      maxLength: 255
      example: "invoice-2026-001.pdf"
    correlationId:
      type: [string, "null"]
      description: Client-provided ID for tracking documents across systems
      maxLength: 255
      example: "order-7890"

BatchGenerationItem:
  type: object
  description: Single item in a batch generation request. Both correlationId and filename must be unique within a batch (null values are excluded from uniqueness checks).
  required:
    - templateId
    - variantId
    - data
  properties:
    templateId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of template to use for generation
      example: invoice
    variantId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of the variant to use
      example: english
    versionId:
      type: [integer, "null"]
      minimum: 1
      maximum: 200
      description: Explicit version ID (version number, 1-200, mutually exclusive with environmentId)
      example: 1
    environmentId:
      type: [string, "null"]
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 30
      description: Slug identifier of environment to determine version from (mutually exclusive with versionId)
      example: null
    data:
      type: object
      description: JSON data to populate the template
      example:
        customerName: "Jane Smith"
        invoiceNumber: "INV-2026-001"
        amount: 1250.00
    filename:
      type: [string, "null"]
      description: Optional filename for the generated document. Must be unique within a batch.
      maxLength: 255
      example: "invoice-2026-001.pdf"
    correlationId:
      type: [string, "null"]
      description: Client-provided ID for tracking documents across systems. Must be unique within a batch.
      maxLength: 255
      example: "order-7890"

GenerateBatchRequest:
  type: object
  description: Request to generate multiple documents in a batch
  required:
    - items
  properties:
    items:
      type: array
      description: List of items to generate
      minItems: 1
      items:
        $ref: '#/BatchGenerationItem'

GenerationJobResponse:
  type: object
  description: Response when submitting a generation request
  required:
    - requestId
    - status
    - jobType
    - totalCount
    - createdAt
  properties:
    requestId:
      type: string
      format: uuid
      description: Unique identifier for tracking this generation request
      example: "550e8400-e29b-41d4-a716-446655440000"
    status:
      type: string
      enum: [PENDING, IN_PROGRESS, COMPLETED, FAILED, CANCELLED]
      description: Current status of the request
      example: PENDING
    jobType:
      type: string
      enum: [SINGLE, BATCH]
      description: Type of generation job
      example: SINGLE
    totalCount:
      type: integer
      description: Total number of items to generate
      example: 1
    createdAt:
      type: string
      format: date-time
      description: When the request was created
      example: "2026-02-01T08:00:00Z"
  example:
    requestId: "550e8400-e29b-41d4-a716-446655440000"
    status: PENDING
    jobType: SINGLE
    totalCount: 1
    createdAt: "2026-02-01T08:00:00Z"

DocumentGenerationItemDto:
  type: object
  description: Individual item in a generation batch
  required:
    - id
    - templateId
    - variantId
    - data
    - status
    - createdAt
  properties:
    id:
      type: string
      format: uuid
      description: Unique identifier of this item
      example: "660e8400-e29b-41d4-a716-446655440001"
    templateId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of template used for generation
      example: invoice
    variantId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of the variant used for generation
      example: english
    versionId:
      type: [integer, "null"]
      minimum: 1
      maximum: 200
      description: Explicit version ID (version number, 1-200, if specified)
      example: 1
    environmentId:
      type: [string, "null"]
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 30
      description: Slug identifier of environment (if specified)
      example: null
    data:
      type: object
      description: JSON data used for generation
      example:
        customerName: "Jane Smith"
        invoiceNumber: "INV-2026-001"
        amount: 1250.00
    filename:
      type: [string, "null"]
      description: Requested filename
      example: "invoice-2026-001.pdf"
    correlationId:
      type: [string, "null"]
      description: Client-provided ID for tracking documents across systems
      example: "order-7890"
    status:
      type: string
      enum: [PENDING, IN_PROGRESS, COMPLETED, FAILED]
      description: Status of this item
      example: COMPLETED
    errorMessage:
      type: [string, "null"]
      description: Error message if processing failed
      example: null
    documentId:
      type: [string, "null"]
      format: uuid
      description: ID of the generated document (if successful)
      example: "770e8400-e29b-41d4-a716-446655440002"
    createdAt:
      type: string
      format: date-time
      description: When the item was created
      example: "2026-02-01T08:00:00Z"
    startedAt:
      type: [string, "null"]
      format: date-time
      description: When processing started
      example: "2026-02-01T08:00:01Z"
    completedAt:
      type: [string, "null"]
      format: date-time
      description: When processing completed
      example: "2026-02-01T08:00:03Z"
  example:
    id: "660e8400-e29b-41d4-a716-446655440001"
    templateId: invoice
    variantId: english
    versionId: 1
    environmentId: null
    data:
      customerName: "Jane Smith"
      invoiceNumber: "INV-2026-001"
      amount: 1250.00
    filename: "invoice-2026-001.pdf"
    correlationId: "order-7890"
    status: COMPLETED
    errorMessage: null
    documentId: "770e8400-e29b-41d4-a716-446655440002"
    createdAt: "2026-02-01T08:00:00Z"
    startedAt: "2026-02-01T08:00:01Z"
    completedAt: "2026-02-01T08:00:03Z"

DocumentGenerationJobDto:
  type: object
  description: Generation job summary
  required:
    - id
    - jobType
    - status
    - totalCount
    - completedCount
    - failedCount
    - createdAt
  properties:
    id:
      type: string
      format: uuid
      description: Unique identifier of the request
      example: "550e8400-e29b-41d4-a716-446655440000"
    jobType:
      type: string
      enum: [SINGLE, BATCH]
      description: Type of generation job
      example: SINGLE
    status:
      type: string
      enum: [PENDING, IN_PROGRESS, COMPLETED, FAILED, CANCELLED]
      description: Current status of the request
      example: COMPLETED
    totalCount:
      type: integer
      description: Total number of items to generate
      example: 1
    completedCount:
      type: integer
      description: Number of items successfully completed
      example: 1
    failedCount:
      type: integer
      description: Number of items that failed
      example: 0
    errorMessage:
      type: [string, "null"]
      description: Error message if the job failed
      example: null
    createdAt:
      type: string
      format: date-time
      description: When the request was created
      example: "2026-02-01T08:00:00Z"
    startedAt:
      type: [string, "null"]
      format: date-time
      description: When processing started
      example: "2026-02-01T08:00:01Z"
    completedAt:
      type: [string, "null"]
      format: date-time
      description: When processing completed
      example: "2026-02-01T08:00:03Z"
    progressPercentage:
      type: number
      format: double
      description: Progress percentage (0-100)
      example: 100.0
  example:
    id: "550e8400-e29b-41d4-a716-446655440000"
    jobType: SINGLE
    status: COMPLETED
    totalCount: 1
    completedCount: 1
    failedCount: 0
    errorMessage: null
    createdAt: "2026-02-01T08:00:00Z"
    startedAt: "2026-02-01T08:00:01Z"
    completedAt: "2026-02-01T08:00:03Z"
    progressPercentage: 100.0

GenerationJobDetail:
  type: object
  description: Detailed generation job with all items
  required:
    - request
    - items
  properties:
    request:
      $ref: '#/DocumentGenerationJobDto'
    items:
      type: array
      description: List of items in this batch
      items:
        $ref: '#/DocumentGenerationItemDto'
  example:
    request:
      id: "550e8400-e29b-41d4-a716-446655440000"
      jobType: SINGLE
      status: COMPLETED
      totalCount: 1
      completedCount: 1
      failedCount: 0
      errorMessage: null
      createdAt: "2026-02-01T08:00:00Z"
      startedAt: "2026-02-01T08:00:01Z"
      completedAt: "2026-02-01T08:00:03Z"
      progressPercentage: 100.0
    items:
      - id: "660e8400-e29b-41d4-a716-446655440001"
        templateId: invoice
        variantId: english
        versionId: 1
        environmentId: null
        data:
          customerName: "Jane Smith"
          invoiceNumber: "INV-2026-001"
          amount: 1250.00
        filename: "invoice-2026-001.pdf"
        correlationId: "order-7890"
        status: COMPLETED
        errorMessage: null
        documentId: "770e8400-e29b-41d4-a716-446655440002"
        createdAt: "2026-02-01T08:00:00Z"
        startedAt: "2026-02-01T08:00:01Z"
        completedAt: "2026-02-01T08:00:03Z"

GenerationJobListResponse:
  type: object
  description: Paginated list of generation jobs
  required:
    - items
    - page
    - size
    - totalElements
    - totalPages
  properties:
    items:
      type: array
      description: List of generation jobs on this page
      items:
        $ref: '#/DocumentGenerationJobDto'
    page:
      type: integer
      description: Current page number (0-based)
      example: 0
    size:
      type: integer
      description: Number of items per page
      example: 20
    totalElements:
      type: integer
      description: Total number of items across all pages
      example: 1
    totalPages:
      type: integer
      description: Total number of pages
      example: 1
  example:
    items:
      - id: "550e8400-e29b-41d4-a716-446655440000"
        jobType: SINGLE
        status: COMPLETED
        totalCount: 1
        completedCount: 1
        failedCount: 0
        errorMessage: null
        createdAt: "2026-02-01T08:00:00Z"
        startedAt: "2026-02-01T08:00:01Z"
        completedAt: "2026-02-01T08:00:03Z"
        progressPercentage: 100.0
    page: 0
    size: 20
    totalElements: 1
    totalPages: 1

DocumentDto:
  type: object
  description: Generated document metadata
  required:
    - id
    - tenantId
    - templateId
    - variantId
    - versionId
    - filename
    - contentType
    - sizeBytes
    - createdAt
  properties:
    id:
      type: string
      format: uuid
      description: Unique identifier of the document
      example: "770e8400-e29b-41d4-a716-446655440002"
    tenantId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 63
      description: Slug identifier of the tenant that owns this document
      example: acme-corp
    templateId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of template used to generate this document
      example: invoice
    variantId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of the variant used to generate this document
      example: english
    versionId:
      type: integer
      minimum: 1
      maximum: 200
      description: Version used to generate this document (version number, 1-200)
      example: 1
    filename:
      type: string
      description: Filename of the document
      example: "invoice-2026-001.pdf"
    correlationId:
      type: [string, "null"]
      description: Client-provided ID for tracking documents across systems
      example: "order-7890"
    contentType:
      type: string
      description: MIME type of the document
      example: "application/pdf"
    sizeBytes:
      type: integer
      format: int64
      description: Size of the document in bytes
      example: 184320
    createdAt:
      type: string
      format: date-time
      description: When the document was generated
      example: "2026-02-01T08:00:03Z"
    createdBy:
      type: [string, "null"]
      description: User who generated the document (future feature)
      example: null
  example:
    id: "770e8400-e29b-41d4-a716-446655440002"
    tenantId: acme-corp
    templateId: invoice
    variantId: english
    versionId: 1
    filename: "invoice-2026-001.pdf"
    correlationId: "order-7890"
    contentType: "application/pdf"
    sizeBytes: 184320
    createdAt: "2026-02-01T08:00:03Z"
    createdBy: null

DocumentListResponse:
  type: object
  description: Paginated list of documents
  required:
    - items
    - page
    - size
    - totalElements
    - totalPages
  properties:
    items:
      type: array
      description: List of documents on this page
      items:
        $ref: '#/DocumentDto'
    page:
      type: integer
      description: Current page number (0-based)
      example: 0
    size:
      type: integer
      description: Number of items per page
      example: 20
    totalElements:
      type: integer
      description: Total number of items across all pages
      example: 1
    totalPages:
      type: integer
      description: Total number of pages
      example: 1
  example:
    items:
      - id: "770e8400-e29b-41d4-a716-446655440002"
        tenantId: acme-corp
        templateId: invoice
        variantId: english
        versionId: 1
        filename: "invoice-2026-001.pdf"
        correlationId: "order-7890"
        contentType: "application/pdf"
        sizeBytes: 184320
        createdAt: "2026-02-01T08:00:03Z"
        createdBy: null
    page: 0
    size: 20
    totalElements: 1
    totalPages: 1
