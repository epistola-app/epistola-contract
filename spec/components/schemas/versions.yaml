VersionDto:
  type: object
  description: Template version with content and lifecycle state. The id field IS the version number (1-200).
  required:
    - id
    - variantId
    - status
    - createdAt
  properties:
    id:
      type: integer
      minimum: 1
      maximum: 200
      description: Version identifier (also the version number, 1-200)
      example: 1
    variantId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of the variant this version belongs to
      example: english
    templateModel:
      type: object
      description: The template model defining the document structure
      example:
        blocks:
          - type: header
            level: 1
            content: "Invoice {{invoiceNumber}}"
          - type: columns
            columns:
              - blocks:
                  - type: paragraph
                    content: "**From:** Acme Corporation\n1 Enterprise Way\nSpringfield, IL 62704"
              - blocks:
                  - type: paragraph
                    content: "**To:** {{customer.name}}\n{{customer.address.street}}\n{{customer.address.city}}, {{customer.address.postalCode}}"
          - type: metadata
            fields:
              - label: "Issue Date"
                value: "{{issueDate}}"
              - label: "Due Date"
                value: "{{dueDate}}"
              - label: "Currency"
                value: "{{currency}}"
          - type: table
            dataSource: "{{lineItems}}"
            columns:
              - header: "Description"
                field: "description"
              - header: "Qty"
                field: "quantity"
                align: right
              - header: "Unit Price"
                field: "unitPrice"
                format: currency
              - header: "Tax %"
                field: "taxRate"
                format: percentage
          - type: divider
          - type: paragraph
            style: caption
            content: "{{#if notes}}Note: {{notes}}{{/if}}"
          - type: paragraph
            style: bold
            content: "Total Due: {{currency}} {{summary.total}}"
    status:
      type: string
      enum:
        - draft
        - published
        - archived
      description: Lifecycle status of this version
      example: published
    createdAt:
      type: string
      format: date-time
      description: Timestamp when the version was created
      example: "2026-01-22T09:00:00Z"
    publishedAt:
      type:
        - string
        - 'null'
      format: date-time
      description: Timestamp when the version was published
      example: "2026-01-25T14:00:00Z"
    archivedAt:
      type:
        - string
        - 'null'
      format: date-time
      description: Timestamp when the version was archived
      example: null
  example:
    id: 1
    variantId: english
    templateModel:
      blocks:
        - type: header
          level: 1
          content: "Invoice {{invoiceNumber}}"
        - type: columns
          columns:
            - blocks:
                - type: paragraph
                  content: "**From:** Acme Corporation\n1 Enterprise Way\nSpringfield, IL 62704"
            - blocks:
                - type: paragraph
                  content: "**To:** {{customer.name}}\n{{customer.address.street}}\n{{customer.address.city}}, {{customer.address.postalCode}}"
        - type: metadata
          fields:
            - label: "Issue Date"
              value: "{{issueDate}}"
            - label: "Due Date"
              value: "{{dueDate}}"
            - label: "Currency"
              value: "{{currency}}"
        - type: table
          dataSource: "{{lineItems}}"
          columns:
            - header: "Description"
              field: "description"
            - header: "Qty"
              field: "quantity"
              align: right
            - header: "Unit Price"
              field: "unitPrice"
              format: currency
            - header: "Tax %"
              field: "taxRate"
              format: percentage
        - type: divider
        - type: paragraph
          style: caption
          content: "{{#if notes}}Note: {{notes}}{{/if}}"
        - type: paragraph
          style: bold
          content: "Total Due: {{currency}} {{summary.total}}"
    status: published
    createdAt: "2026-01-22T09:00:00Z"
    publishedAt: "2026-01-25T14:00:00Z"
    archivedAt: null

VersionSummaryDto:
  type: object
  description: Summary view of a version for list displays. The id field IS the version number (1-200).
  required:
    - id
    - variantId
    - status
    - createdAt
  properties:
    id:
      type: integer
      minimum: 1
      maximum: 200
      description: Version identifier (also the version number, 1-200)
      example: 1
    variantId:
      type: string
      pattern: '^[a-z][a-z0-9]*(-[a-z0-9]+)*$'
      minLength: 3
      maxLength: 50
      description: Slug identifier of the variant this version belongs to
      example: english
    status:
      type: string
      enum:
        - draft
        - published
        - archived
      description: Lifecycle status of this version
      example: published
    createdAt:
      type: string
      format: date-time
      description: Timestamp when the version was created
      example: "2026-01-22T09:00:00Z"
    publishedAt:
      type:
        - string
        - 'null'
      format: date-time
      description: Timestamp when the version was published
      example: "2026-01-25T14:00:00Z"
    archivedAt:
      type:
        - string
        - 'null'
      format: date-time
      description: Timestamp when the version was archived
      example: null
  example:
    id: 1
    variantId: english
    status: published
    createdAt: "2026-01-22T09:00:00Z"
    publishedAt: "2026-01-25T14:00:00Z"
    archivedAt: null

UpdateDraftRequest:
  type: object
  description: Request body for updating a draft version
  properties:
    templateModel:
      type: object
      description: Template model structure
      example:
        blocks:
          - type: header
            level: 1
            content: "Invoice {{invoiceNumber}}"
          - type: columns
            columns:
              - blocks:
                  - type: paragraph
                    content: "**From:** Acme Corporation\n1 Enterprise Way\nSpringfield, IL 62704"
              - blocks:
                  - type: paragraph
                    content: "**To:** {{customer.name}}\n{{customer.address.street}}\n{{customer.address.city}}, {{customer.address.postalCode}}"
          - type: table
            dataSource: "{{lineItems}}"
            columns:
              - header: "Description"
                field: "description"
              - header: "Qty"
                field: "quantity"
                align: right
              - header: "Unit Price"
                field: "unitPrice"
                format: currency
          - type: paragraph
            style: bold
            content: "Total Due: {{currency}} {{summary.total}}"

VersionListResponse:
  type: object
  description: List of template versions
  required:
    - items
  properties:
    items:
      type: array
      description: List of versions
      items:
        $ref: '#/VersionSummaryDto'
  example:
    items:
      - id: 1
        variantId: english
        status: published
        createdAt: "2026-01-22T09:00:00Z"
        publishedAt: "2026-01-25T14:00:00Z"
        archivedAt: null
      - id: 2
        variantId: english
        status: published
        createdAt: "2026-01-26T10:00:00Z"
        publishedAt: "2026-01-28T11:00:00Z"
        archivedAt: null
